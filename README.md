# sv - Supervisorè¿›ç¨‹ç®¡ç†å·¥å…· ğŸš€

ä¸€ä¸ªåŸºäºGoè¯­è¨€å¼€å‘çš„ç°ä»£åŒ–Supervisorè¿›ç¨‹ç®¡ç†å·¥å…·ï¼Œæ”¯æŒåºå·æ“ä½œï¼Œè®©è¿›ç¨‹ç®¡ç†æ›´åŠ ä¾¿æ·ï¼

## âœ¨ ç‰¹æ€§

- ğŸ¯ **åºå·æ“ä½œ** - ä½¿ç”¨æ•°å­—åºå·ä»£æ›¿é•¿è¿›ç¨‹åï¼Œæ“ä½œæ›´å¿«é€Ÿ
- ğŸ“Š **ç¾è§‚æ˜¾ç¤º** - å½©è‰²çŠ¶æ€æ˜¾ç¤ºï¼Œè¿è¡Œæ—¶é—´æ ¼å¼åŒ–
- ğŸ”§ **çµæ´»æ§åˆ¶** - æ”¯æŒå•ä¸ªã€å¤šä¸ªã€èŒƒå›´æ“ä½œ
- ğŸŒ **è¿œç¨‹ç®¡ç†** - æ”¯æŒè®¤è¯è¿œç¨‹SupervisoræœåŠ¡å™¨
- ğŸ’¡ **æ™ºèƒ½æç¤º** - å‹å¥½çš„é”™è¯¯æç¤ºå’Œä½¿ç”¨è¯´æ˜
- ğŸ¨ **çŠ¶æ€å›¾æ ‡** - ç›´è§‚çš„è¿›ç¨‹çŠ¶æ€å›¾æ ‡æ˜¾ç¤º

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¼–è¯‘

```bash
go build -o sv main.go
```

### åŸºæœ¬ä½¿ç”¨

```bash
# æŸ¥çœ‹æ‰€æœ‰è¿›ç¨‹çŠ¶æ€ï¼ˆå¸¦åºå·ï¼‰
./sv status
./sv list      # åŒstatus

# é‡å¯åºå·ä¸º1çš„è¿›ç¨‹
./sv restart 1

# åœæ­¢åºå·ä¸º2ã€4ã€6çš„è¿›ç¨‹
./sv stop 2 4 6

# å¯åŠ¨åºå·1åˆ°3çš„æ‰€æœ‰è¿›ç¨‹
./sv start 1-3

# ä½¿ç”¨è¿›ç¨‹åæ“ä½œï¼ˆå…¼å®¹ä¼ ç»Ÿæ–¹å¼ï¼‰
./sv restart nginx redis

# æ··åˆä½¿ç”¨
./sv restart 1 nginx 3-5
```

## ğŸ“‹ å‘½ä»¤å‚è€ƒ

### ä¸»è¦å‘½ä»¤

| å‘½ä»¤ | æè¿° | ç¤ºä¾‹ |
|------|------|------|
| `status` | æ˜¾ç¤ºæ‰€æœ‰è¿›ç¨‹çŠ¶æ€ | `./sv status` |
| `list` | æ˜¾ç¤ºæ‰€æœ‰è¿›ç¨‹çŠ¶æ€ï¼ˆåŒstatusï¼‰ | `./sv list` |
| `start` | å¯åŠ¨æŒ‡å®šè¿›ç¨‹ | `./sv start 1` |
| `stop` | åœæ­¢æŒ‡å®šè¿›ç¨‹ | `./sv stop 1-3` |
| `restart` | é‡å¯æŒ‡å®šè¿›ç¨‹ | `./sv restart nginx` |
| `help` | æ˜¾ç¤ºå¸®åŠ©ä¿¡æ¯ | `./sv help` |

### è¿›ç¨‹å‚æ•°æ ¼å¼

| æ ¼å¼ | è¯´æ˜ | ç¤ºä¾‹ |
|------|------|------|
| `åºå·` | ä½¿ç”¨æ•°å­—åºå· | `./sv restart 1` |
| `åç§°` | ä½¿ç”¨è¿›ç¨‹åç§° | `./sv restart myapp` |
| `å¤šä¸ª` | ç©ºæ ¼åˆ†éš”å¤šä¸ªå‚æ•° | `./sv restart 1 3 5` |
| `èŒƒå›´` | æ¨ªçº¿è¡¨ç¤ºåºå·èŒƒå›´ | `./sv restart 1-5` |

## ğŸ”§ ç¯å¢ƒé…ç½®

é€šè¿‡ç¯å¢ƒå˜é‡é…ç½®Supervisorè¿æ¥ï¼š

```bash
# Supervisor RPCæœåŠ¡å™¨åœ°å€
export SUPERVISOR_HOST="http://localhost:9001/RPC2"

# å¦‚æœéœ€è¦è®¤è¯
export SUPERVISOR_USER="your_username"
export SUPERVISOR_PASSWORD="your_password"
```

### é…ç½®ç¤ºä¾‹

```bash
# æœ¬åœ°é»˜è®¤é…ç½®
./sv status

# è¿œç¨‹æœåŠ¡å™¨é…ç½®
SUPERVISOR_HOST="http://192.168.1.100:9001/RPC2" ./sv status

# å¸¦è®¤è¯çš„é…ç½®
SUPERVISOR_HOST="http://remote-server:9001/RPC2" \\
SUPERVISOR_USER="admin" \\
SUPERVISOR_PASSWORD="secret123" \\
./sv status
```

## ğŸ“Š çŠ¶æ€è¯´æ˜

| çŠ¶æ€ä»£ç  | çŠ¶æ€åç§° | é¢œè‰² | å›¾æ ‡ |
|----------|----------|------|------|
| 20 | RUNNING | ç»¿è‰² | âœ… è¿è¡Œä¸­ |
| 10 | STARTING | é»„è‰² | ğŸš€ å¯åŠ¨ä¸­ |
| 30 | STOPPING | é»„è‰² | â¹ï¸ åœæ­¢ä¸­ |
| 0 | STOPPED | ç™½è‰² | â¸ï¸ å·²åœæ­¢ |
| 100 | FATAL | çº¢è‰² | âŒ è‡´å‘½é”™è¯¯ |
| 200 | BACKOFF | é»„è‰² | âš ï¸ é‡è¯•ä¸­ |

## ğŸ¯ ä½¿ç”¨åœºæ™¯

### æ—¥å¸¸è¿ç»´
```bash
# å¿«é€ŸæŸ¥çœ‹æ‰€æœ‰æœåŠ¡çŠ¶æ€
./sv status
./sv list      # åŒstatus

# é‡å¯webæœåŠ¡
./sv restart 1

# é‡å¯æ‰€æœ‰æ•°æ®åº“æœåŠ¡
./sv restart 5-7
```

### æ‰¹é‡æ“ä½œ
```bash
# åœæ­¢æ‰€æœ‰æµ‹è¯•æœåŠ¡
./sv stop 8 10 12

# å¯åŠ¨æ‰€æœ‰æ ¸å¿ƒæœåŠ¡
./sv start 1-4
```

### é—®é¢˜æ’æŸ¥
```bash
# æŸ¥çœ‹çŠ¶æ€å¼‚å¸¸çš„æœåŠ¡
./sv status
./sv list      # åŒstatus

# é‡å¯é—®é¢˜æœåŠ¡
./sv restart 3
```

## ğŸŒŸ è¾“å‡ºç¤ºä¾‹

```
ğŸ” Supervisorè¿›ç¨‹çŠ¶æ€ (å…±4ä¸ªè¿›ç¨‹)
================================================================================
åºå·   åç§°                   çŠ¶æ€         PID      è¿è¡Œæ—¶é—´            æè¿°
--------------------------------------------------------------------------------
1    nginx                RUNNING    1234     2å°æ—¶15åˆ†          âœ… è¿è¡Œä¸­
2    redis                RUNNING    5678     1å¤©3å°æ—¶           âœ… è¿è¡Œä¸­
3    mysql                STOPPED    -        å·²åœæ­¢             â¸ï¸ å·²åœæ­¢
4    app                  STARTING   -        å¯åŠ¨ä¸­...          ğŸš€ å¯åŠ¨ä¸­
================================================================================

ğŸ’¡ æç¤º: ä½¿ç”¨ 'sv start/stop/restart <åºå·>' æ¥æ§åˆ¶è¿›ç¨‹
```

## ğŸ› ï¸ å¼€å‘

### ä¾èµ–

- Go 1.21+
- ä»…ä½¿ç”¨æ ‡å‡†åº“ï¼Œæ— å¤–éƒ¨ä¾èµ–

### ç¼–è¯‘

```bash
# å¼€å‘ç¯å¢ƒ
go run main.go status

# ç”Ÿäº§ç¼–è¯‘
go build -ldflags="-s -w" -o sv main.go

# äº¤å‰ç¼–è¯‘
GOOS=linux GOARCH=amd64 go build -o sv-linux-amd64 main.go
GOOS=windows GOARCH=amd64 go build -o sv-windows-amd64.exe main.go
```

## ğŸ” æ•…éšœæ’é™¤

### è¿æ¥é—®é¢˜
å¦‚æœé‡åˆ°è¿æ¥é”™è¯¯ï¼š

1. ç¡®ä¿SupervisoræœåŠ¡æ­£åœ¨è¿è¡Œ
2. æ£€æŸ¥ç«¯å£é…ç½®ï¼ˆé»˜è®¤9001ï¼‰
3. ç¡®è®¤é˜²ç«å¢™è®¾ç½®
4. éªŒè¯è®¤è¯ä¿¡æ¯

### é…ç½®æ–‡ä»¶
ç¡®ä¿`supervisord.conf`åŒ…å«XML-RPCæ¥å£é…ç½®ï¼š

```ini
[inet_http_server]
port=127.0.0.1:9001
username=user
password=pass

[rpcinterface:supervisor]
supervisor.rpcinterface_factory = supervisor.rpcinterface:make_main_rpcinterface

[supervisord]
rpcinterface_files = supervisord
```

## ğŸ¤ è´¡çŒ®

æ¬¢è¿æäº¤Issueå’ŒPull Requestï¼

## ğŸ“„ è®¸å¯è¯

MIT License

---

**äº«å—ä¾¿æ·çš„è¿›ç¨‹ç®¡ç†ä½“éªŒï¼** ğŸ‰